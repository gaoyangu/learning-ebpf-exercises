## Question 03

在其中一个示例程序运行期间，使用 `bpftool map update` 命令修改 `config` 映射。使用 `sudo -u username` 命令验证这些配置变更是否被 eBPF 程序识别并生效。

## Answer

1. 运行 hello-buffer-config.py

```sh
$ cd chapter4
$ ./hello-buffer-config.py
```

2. 查看 config 的 ID

```sh
$ bpftool map list name config
53: hash  name config  flags 0x0
        key 4B  value 13B  max_entries 10240  memlock 1001216B
        btf_id 74
```

3. 查看 config 的内容

```sh
$ bpftool map dump name config
[{
        "key": 0,
        "value": {
            "message": "Hey root!"
        }
    },{
        "key": 1000,
        "value": {
            "message": [72,105,32,117,115,101,114,32,49,48,48,48,33
            ]
        }
    }
]
```

4. 更新 config 中 key 为 0 对应的 value

```sh
$ bpftool map update id 53 key 0 0 0 0  value 114 111 111 116 32 117 112 100 97 116 101 32 33
```

5. 查看运行 hello-buffer-config.py 的终端的输出信息，确认是否生效

```sh
87997 0 bash Hey root!
...
88193 0 bash root update 
```

## References

- [bpftool-map](https://github.com/libbpf/bpftool/blob/main/docs/bpftool-map.rst#examples)