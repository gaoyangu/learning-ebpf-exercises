## Question 03

编写一个 `kprobe` 和/或 `fentry` 类型的 eBPF 程序，使其在其他内核函数被调用时触发执行。你可以通过查看 `/proc/kallsyms` 文件，找到当前内核版本中可探测的所有内核函数。

## Answer

1. 代码编写（由千问提供技术支持）

- [trace_unlink.bpf.c](./03/trace_unlink.bpf.c)
- [trace_unlink.c](./03/trace_unlink.c)

2. 编译运行

```sh
$ sudo ./trace_unlink
Tracing unlink calls via kprobe/fentry. Hit Ctrl+C to exit.
```

```sh
$ sudo cat /sys/kernel/debug/tracing/trace_pipe
...
    <...>-76561   [001] ...31 95216.717675: bpf_trace_printk: kprobe: unlink called on file: testfile

    <...>-76561   [001] ...11 95216.717717: bpf_trace_printk: fentry: unlink called on file: testfile
```

```sh
$ touch testfile && rm testfile
```