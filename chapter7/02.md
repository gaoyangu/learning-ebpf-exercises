## Question 02

`hello.c` 中的用户态示例代码会加载 `hello.bpf.o` 中定义的所有程序对象。作为编写 `libbpf` 用户态代码的练习，请修改该示例代码，使其仅加载并挂载其中一个 eBPF 程序（任选其一即可），且无需从 `hello.bpf.c` 中删除其他程序的代码。

## Answer

1. 代码修改

```diff
--- a/chapter7/hello.c
+++ b/chapter7/hello.c
@@ -33,6 +33,9 @@ int main()
     int err;
        struct perf_buffer *pb = NULL;

+       struct bpf_link *link = NULL;
+       struct bpf_program *prog;
+
        libbpf_set_print(libbpf_print_fn);

        char log_buf[64 * 1024];
@@ -63,14 +66,28 @@ int main()
                return 1;
        }

-       // Attach the progams to the events
-       err = hello_bpf__attach(skel);
-       if (err) {
-               fprintf(stderr, "Failed to attach BPF skeleton: %d\n", err);
+       prog = bpf_object__find_program_by_name(skel->obj, "kprobe_sys_execve");
+       if (!prog) {
+               fprintf(stderr, "Failed to find BPF program\n");
                hello_bpf__destroy(skel);
-        return 1;
+               return 1;
        }

+       link = bpf_program__attach(prog);
+       if (!link) {
+               fprintf(stderr, "Failed to attach BPF program\n");
+               hello_bpf__destroy(skel);
+               return 1;
+       }
+
+       // Attach the progams to the events
+       // err = hello_bpf__attach(skel);
+       // if (err) {
+       //      fprintf(stderr, "Failed to attach BPF skeleton: %d\n", err);
+       //      hello_bpf__destroy(skel);
+    //     return 1;
+       // }
+
        pb = perf_buffer__new(bpf_map__fd(skel->maps.output), 8, handle_event, lost_event, NULL, NULL);
        if (!pb) {
                err = -1;
```

2. 编译运行